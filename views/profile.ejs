<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="/images/favicon.png">
    <link rel="stylesheet" href="/css/global.css">
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/accessibility.css">
    <link rel="stylesheet" href="/css/footer.css">
    <link rel="stylesheet" href="/css/profile.css">
    <script src="/js/menu-button.js" defer ></script>
    <script src="/js/showAccessibility.js" defer ></script>
    <script src="/js/accessibility-button.js" defer ></script>
    <script src="/js/accessibility.js" defer ></script>
    <link href="https://fonts.googleapis.com/css2?family=Karla:wght@200;400;600&display=swap" rel="stylesheet">
<!-- 
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"> -->
    <title>PixelPulse - Profile</title>
</head>
<body>
    <%- include('partials/navbar') %>

    <%- include('partials/accessibilityMenu') %>

    <main>
      <div class="profile-container">
        <div class="profile-main">
          <img src="<%= user.profile_picture || 'dfpic.jpg' %>" alt="Profile picture" class="profile-page-picture">
          
          <div>
            <div class="profile-top-row">
              <div>
                <h2><%= user.username %></h2>
                <p class="profile-user-role"><%= user.role %> | Member since: <%= new Date(user.created_at).toLocaleDateString() %></p>
              </div>
              
              <button class="profile-button">Edit Profile</button>
            </div>
    
            <div class="profile-second-row">
              <h3>x Posts</h3>
              <h3>x Likes</h3>
            </div>
          </div>
        </div>
      </div>
      
      <hr class="profile-line">

      <section class="posts-container">
        <div class="posts-heading">
          <img src="/images/posts-icon-light.png" class="post-icon" id="post-icon-light">
          <img src="/images/posts-icon-dark.png" class="post-icon" id="post-icon-dark">
          <p class="post-text">POSTS</p>
        </div>
  
        <div class="profile-card">
          <% let displayUploadCard = true; %>
  
          <% projects.forEach(project => { %>
            <% if(displayUploadCard) { %>
              <div class="upload-project">
                <a href="/upload" class="upload-link">
                  <img src="/images/upload-icon-light.png" class="upload-icon" id="upload-icon-light">
                  <img src="/images/upload-icon-dark.png" class="upload-icon" id="upload-icon-dark">
                  <p>Upload Project</p>
                </a>
              </div>
  
              <% displayUploadCard = false; %>
            <% } %>
  
            <a href="/project/<%= project.id %>" class="profile-card-link">
              <img src="<%= project.project_picture || '/images/default_project_image.jpg' %>" alt="<%= project.title %>" class="profile-card-image">
              <div class="profile-card-body">
                  <h2 class="profile-card-title"><%= project.title %></h2>
                  <div class="profile-card-likes-container">
                    <img src="/images/like-icon-dark.png" class="profile-card-likes-icon">
                    <h3 class="profile-card-likes"><%= project.likes || 0 %></h3>
                  </div>
                  
              </div>
            </a>
          <% }); %>
        </div>
      </section>

      <form action="/profile/update" method="POST" enctype="multipart/form-data">
        <div>
          <div class="form-group">
              <label for="username">Username:</label>
              <input type="text" class="form-control" id="username" name="username" value="<%= user.username %>">
          </div>
          <div class="form-group">
              <label for="email">Email:</label>
              <input type="email" class="form-control" id="email" name="email" value="<%= user.email %>">
          </div>
          <div class="form-group">
              <label for="role">Role:</label>
              <input type="text" class="form-control" id="role" name="role" value="<%= user.role %>">
          </div>
          <div class="form-group">
              <label for="profile_picture">Profile Picture:</label>
              <input type="file" class="form-control-file" id="profile_picture" name="profile_picture">
          </div>
        </div>
        <button type="submit">Save changes</button>
      </form>
    </main>
    
    <%- include('partials/footer') %>
</body>
</html>
